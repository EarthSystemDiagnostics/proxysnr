<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to proxysnr • proxysnr</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to proxysnr">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">proxysnr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/proxysnr.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/calculate-transfer-functions.html">Calculate transfer functions</a></li>
    <li><a class="dropdown-item" href="../articles/plot-muench-laepple-figures.html">Plot results of Münch &amp; Laepple (2018)</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EarthSystemDiagnostics/proxysnr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to proxysnr</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/EarthSystemDiagnostics/proxysnr/blob/master/vignettes/proxysnr.Rmd" class="external-link"><code>vignettes/proxysnr.Rmd</code></a></small>
      <div class="d-none name"><code>proxysnr.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/EarthSystemDiagnostics/proxysnr" class="external-link">proxysnr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>With <code>proxysnr</code> you can apply spectral analyses to climate
proxy records that were obtained from a spatial array of proxy
observation locations, e.g. ice cores, marine sediment cores, tree
rings, etc., to derive the power spectral density (PSD, or, in short,
spectrum) of the record’s common signal and the PSD of the local noise
(for details see Münch and Laepple, 2018)</p>
<p>To work with <code>proxysnr</code>, supply the proxy records in form
of a list, or a data frame, with each list element or data column
representing one of the proxy observation locations, where the proxy
data were sampled over time, depth, or any other given variable, at
equal intervals. Note that the equidistance of the sampling intervals is
mandatory to obtain correct spectra.</p>
<p>To showcase the analyses available with <code>proxysnr</code> we
create an artifical proxy dataset which mimicks five observation
locations, each sampling the proxy data at 1000 sampling points:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">20241030</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># five "cores" (proxy observation locations)</span></span>
<span><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fl">5</span></span>
<span><span class="co"># number of sampling points (e.g. time steps) at each location</span></span>
<span><span class="va">nt</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span></span>
<span><span class="co"># simulate a common climate signal as an AR-1 process</span></span>
<span><span class="va">clim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/arima.sim.html" class="external-link">arima.sim</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ar <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span>, n <span class="op">=</span> <span class="va">nt</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># simulate the independent proxy noise as a white noise process</span></span>
<span><span class="va">noise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">replicate</a></span><span class="op">(</span><span class="va">nc</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span>n <span class="op">=</span> <span class="va">nt</span>, sd <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># create a data frame (i.e. a "spatial array") of five "cores" that record the</span></span>
<span><span class="co"># same climate signal (scaled to make it relatively a bit stronger) but</span></span>
<span><span class="co"># independent noise</span></span>
<span><span class="va">cores</span> <span class="op">&lt;-</span> <span class="fl">1.2</span> <span class="op">*</span> <span class="va">clim</span> <span class="op">+</span> <span class="va">noise</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="obtaining-and-plotting-the-proxy-array-spectra">Obtaining and plotting the proxy array spectra<a class="anchor" aria-label="anchor" href="#obtaining-and-plotting-the-proxy-array-spectra"></a>
</h2>
<p>A first step is to calculate the PSD for each proxy record, obtain
the average spectrum of these individual spectra, and get the spectrum
of the data series when averaging across all proxy records (the
“stacked” record); all of which is handled by the function
<code><a href="../reference/ObtainArraySpectra.html">ObtainArraySpectra()</a></code>. We only need to set the sampling
resolution via the parameter <code>res</code> (chosen arbitrarily here)
in order to obtain the correct spectral units, and we can apply some
smoothing to the raw spectral estimates (parameter <code>df.log</code>)
to reduce their spectral uncertainty:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">arrspec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/ObtainArraySpectra.html">ObtainArraySpectra</a></span><span class="op">(</span><span class="va">cores</span>, res <span class="op">=</span> <span class="fl">2</span>, df.log <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">arrspec</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "single" "mean"   "stack"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/attr.html" class="external-link">attr</a></span><span class="op">(</span><span class="va">arrspec</span>, <span class="st">"array.par"</span><span class="op">)</span></span>
<span><span class="co">#&gt;   nc   nt  res </span></span>
<span><span class="co">#&gt;    5 1000    2</span></span></code></pre></div>
<p>The output list contains the attribute <code>array.par</code> which
stores information on the underlying proxy record array, namely the
number of records (“nc”), the number of sampling points per record
(“nt”), and the sampling resolution (“res”), so that other
<code>proxysnr</code> functions have these information available.</p>
<p>The function <code><a href="../reference/PlotArraySpectra.html">PlotArraySpectra()</a></code> directly plots the
results:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/PlotArraySpectra.html">PlotArraySpectra</a></span><span class="op">(</span><span class="va">arrspec</span>, remove <span class="op">=</span> <span class="fl">0</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>                 xlab <span class="op">=</span> <span class="st">"Period (a.u.)"</span>, ylab <span class="op">=</span> <span class="st">"Power spectral density"</span><span class="op">)</span></span></code></pre></div>
<p><img src="proxysnr_files/figure-html/array-spectra-1.png" width="672"></p>
<p>The plot displays the spectra as a function of the inverse spectral
frequency, e.g. time period, which is often more intuitive to interpret.
Each proxy record’s spectrum is shown as a thin grey line (however, you
can change all colours to your likings), and the mean spectrum of all
individual spectra is plotted as the thick black line, which averages
out some spectral uncertainty of the individual spectra and thus
delivers a more accurate representation of the average proxy PSD. If all
proxy record variations were indepedent noise, the spectrum of the
stacked record (thick brown line) would follow the line of the mean
spectrum divided by the number of records, i.e. the black dashed line on
the plot. Hence, the PSD of the spectrum of the stacked record which
exceeds this line (the blue shaded area) results from proxy variability
common to all records, while the spectral energy which is lost (the red
shaded area) represents independent noise variability.</p>
<p>When you do not need to save the intermediate results, you can also
pipe the workflow,</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ObtainArraySpectra.html">ObtainArraySpectra</a></span><span class="op">(</span>res <span class="op">=</span> <span class="fl">2</span>, df.log <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/PlotArraySpectra.html">PlotArraySpectra</a></span><span class="op">(</span>remove <span class="op">=</span> <span class="fl">0</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">50</span><span class="op">)</span>,</span>
<span>                   xlab <span class="op">=</span> <span class="st">"Period (a.u.)"</span>, ylab <span class="op">=</span> <span class="st">"Power spectral density"</span><span class="op">)</span></span></code></pre></div>
<p>and in the following we always show the combined, piped workflow in
order to highlight how the <code>proxysnr</code> functions are
linked.</p>
</div>
<div class="section level2">
<h2 id="signal-and-noise-spectra">Signal and noise spectra<a class="anchor" aria-label="anchor" href="#signal-and-noise-spectra"></a>
</h2>
<p>While the previous plot is visually insightful, the blue and red
shaded areas are only proportional to the actual signal and noise
spectra (see Münch and Laepple, 2018 for details); these are instead
calculated using <code><a href="../reference/SeparateSignalFromNoise.html">SeparateSignalFromNoise()</a></code> which delivers
also the spectrum of the signal-to-noise ratio, which is an important
quantity to interpret proxy variability in terms of climate
variability.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="va">cores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ObtainArraySpectra.html">ObtainArraySpectra</a></span><span class="op">(</span>res <span class="op">=</span> <span class="fl">2</span>, df.log <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/SeparateSignalFromNoise.html">SeparateSignalFromNoise</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">spec</span><span class="op">)</span></span>
<span><span class="co">#&gt; List of 3</span></span>
<span><span class="co">#&gt;  $ signal:List of 2</span></span>
<span><span class="co">#&gt;   ..$ freq: num [1:500] 0.0005 0.001 0.0015 0.002 0.0025 0.003 0.0035 0.004 0.0045 0.005 ...</span></span>
<span><span class="co">#&gt;   ..$ spec: num [1:500] 8.21 13.57 19.86 38.26 44.7 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "class")= chr "spec"</span></span>
<span><span class="co">#&gt;  $ noise :List of 2</span></span>
<span><span class="co">#&gt;   ..$ freq: num [1:500] 0.0005 0.001 0.0015 0.002 0.0025 0.003 0.0035 0.004 0.0045 0.005 ...</span></span>
<span><span class="co">#&gt;   ..$ spec: num [1:500] 1.56 3.04 3.72 4.03 4.04 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "class")= chr "spec"</span></span>
<span><span class="co">#&gt;  $ snr   :List of 2</span></span>
<span><span class="co">#&gt;   ..$ freq: num [1:500] 0.0005 0.001 0.0015 0.002 0.0025 0.003 0.0035 0.004 0.0045 0.005 ...</span></span>
<span><span class="co">#&gt;   ..$ spec: num [1:500] 5.26 4.47 5.33 9.5 11.08 ...</span></span>
<span><span class="co">#&gt;   ..- attr(*, "class")= chr "spec"</span></span>
<span><span class="co">#&gt;  - attr(*, "array.par")= Named num [1:3] 5 1000 2</span></span>
<span><span class="co">#&gt;   ..- attr(*, "names")= chr [1:3] "nc" "nt" "res"</span></span></code></pre></div>
<p>There are two plotting routines available in <code>proxysnr</code>,
<code><a href="../reference/LPlot.html">LPlot()</a></code> and <code><a href="../reference/LLines.html">LLines()</a></code>, to plot any spectral
object returned by its functions automatically on double-logarithmic
axes. These follow the concept of base R’s <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> and
<code><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines()</a></code> functions and can thus make a fresh spectrum plot
or add a spectrum to an existing plot. So to plot the results from our
analyses in <code>spec</code> we can write</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">op</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">5</span>, <span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>, las <span class="op">=</span> <span class="fl">1</span>,</span>
<span>          cex.main <span class="op">=</span> <span class="fl">1.5</span>, cex.lab <span class="op">=</span> <span class="fl">1.5</span>, cex.axis <span class="op">=</span> <span class="fl">1.25</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/LPlot.html">LPlot</a></span><span class="op">(</span><span class="va">spec</span><span class="op">$</span><span class="va">signal</span>, inverse <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      xlab <span class="op">=</span> <span class="st">"Period (a.u.)"</span>, ylab <span class="op">=</span> <span class="st">"Power spectral density"</span>,</span>
<span>      xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">50</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"dodgerblue4"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/LLines.html">LLines</a></span><span class="op">(</span><span class="va">spec</span><span class="op">$</span><span class="va">noise</span>, inverse <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"firebrick4"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal"</span>, <span class="st">"Noise"</span><span class="op">)</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"dodgerblue4"</span>, <span class="st">"firebrick4"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span>, bty <span class="op">=</span> <span class="st">"n"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/LPlot.html">LPlot</a></span><span class="op">(</span><span class="va">spec</span><span class="op">$</span><span class="va">snr</span>, inverse <span class="op">=</span> <span class="cn">TRUE</span>, xlab <span class="op">=</span> <span class="st">"Period (a.u.)"</span>, ylab <span class="op">=</span> <span class="st">"SNR"</span>,</span>
<span>      xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2000</span>, <span class="fl">2</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">50</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"black"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">op</span><span class="op">)</span></span></code></pre></div>
<p><img src="proxysnr_files/figure-html/plot-sn-spectra-1.png" width="47%"><img src="proxysnr_files/figure-html/plot-sn-spectra-2.png" width="47%"></p>
<p>We can test whether the estimated noise spectrum indeed reproduces
the standard deviation of <code>1.5</code> of the given white noise
process:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">spec</span><span class="op">$</span><span class="va">noise</span><span class="op">$</span><span class="va">freq</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">df</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">spec</span><span class="op">$</span><span class="va">noise</span><span class="op">$</span><span class="va">spec</span><span class="op">)</span><span class="op">)</span> <span class="co"># ok!</span></span>
<span><span class="co">#&gt; [1] 1.497102</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimating-confidence-intervals">Estimating confidence intervals<a class="anchor" aria-label="anchor" href="#estimating-confidence-intervals"></a>
</h2>
<p>Since confidence intervals for the signal, noise, and SNR spectra
cannot be obtained analytically, <code>proxysnr</code> offers to
estimate these from a parametric bootstrapping procedure based on Monte
Carlo simulation of surrogate data:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">spec</span> <span class="op">&lt;-</span> <span class="va">cores</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/ObtainArraySpectra.html">ObtainArraySpectra</a></span><span class="op">(</span>res <span class="op">=</span> <span class="fl">2</span>, df.log <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/SeparateSignalFromNoise.html">SeparateSignalFromNoise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/EstimateCI.html">EstimateCI</a></span><span class="op">(</span>nmc <span class="op">=</span> <span class="fl">10</span>, df.log <span class="op">=</span> <span class="fl">0.1</span>, ci.df.log <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></code></pre></div>
<p>The plotting routines <code><a href="../reference/LPlot.html">LPlot()</a></code> and <code><a href="../reference/LLines.html">LLines()</a></code>
automatically add a shading for the confidence intervals to the plot,
when such are available, so the same above plotting code can be used to
reproduce the plots now including the only just estimated confidence
intervals:</p>
<p><img src="proxysnr_files/figure-html/plot-sn-spectra2-1.png" width="47%"><img src="proxysnr_files/figure-html/plot-sn-spectra2-2.png" width="47%"></p>
</div>
<div class="section level2">
<h2 id="correction-of-signal-and-noise-spectra">Correction of signal and noise spectra<a class="anchor" aria-label="anchor" href="#correction-of-signal-and-noise-spectra"></a>
</h2>
<p>During archiving, the proxy records may be subject to smoothing,
e.g. in firn and ice by diffusion, or in marine sediments by
bioturbation. Furthermore, if the proxy records are dated their
chronologies may be uncertain between the records, with this time
uncertainty affecting the reconstruction of the common signal.</p>
<p><code>proxysnr</code> offers to correct the estimated signal and
noise spectra for these effects by supplying respective transfer
functions to <code><a href="../reference/SeparateSignalFromNoise.html">SeparateSignalFromNoise()</a></code> via the function
parameters <code>diffusion</code> and <code>time.uncertainty</code>.
These transfer functions describe the loss in spectral power due to the
smoothing or the uncertain chronologies and need to be assessed and
provided by the user.</p>
<p>For two special cases you can apply <code>proxysnr</code> to directly
calculate the transfer functions: firn diffusion (function
<code><a href="../reference/CalculateDiffusionTF.html">CalculateDiffusionTF()</a></code>) and time uncertainty in
<em>layer-counted</em> chronologies (function
<code><a href="../reference/CalculateTimeUncertaintyTF.html">CalculateTimeUncertaintyTF()</a></code>); see also Münch and Laepple
(2018) for more details on the processes and the implemented estimation,
and the <code><a href="../articles/calculate-transfer-functions.html">vignette("calculate-transfer-functions")</a></code> for
details on using the two functions.</p>
<p>Proxy records also contain measurement noise. If you have an estimate
of its magnitude and its spectral shape, you can supply these
information to <code><a href="../reference/SeparateSignalFromNoise.html">SeparateSignalFromNoise()</a></code> via the
<code>measurement.noise</code> parameter, and the returned noise and SNR
spectra will be corrected for the measurement noise, i.e. they will take
into account only the proxy-specific noise that was created during the
archiving process.</p>
</div>
<div class="section level2">
<h2 id="further-analysis-options">Further analysis options<a class="anchor" aria-label="anchor" href="#further-analysis-options"></a>
</h2>
<p>There are some more <code>proxysnr</code> functions you can use to
conduct and visualise analyses:</p>
<ul>
<li>
<code><a href="../reference/GetIntegratedSNR.html">GetIntegratedSNR()</a></code> delivers the ratio of the integrated
signal and noise spectra, which corresponds to the SNR at a specific
sampling resolution;</li>
<li>
<code><a href="../reference/ObtainStackCorrelation.html">ObtainStackCorrelation()</a></code> calculates the expected
correlation of a stack of proxy records with the common climate signal
as a function of the number of records averaged and the records’
sampling resolution (see Fig. 4 in Münch and Laepple, 2018 for an
example);</li>
<li>
<code><a href="../reference/PlotStackCorrelation.html">PlotStackCorrelation()</a></code> to directly plot the output from
<code><a href="../reference/ObtainStackCorrelation.html">ObtainStackCorrelation()</a></code>;</li>
<li>
<code><a href="../reference/PlotSNR.html">PlotSNR()</a></code> to plot several SNR datasets in one
figure;</li>
<li>
<code><a href="../reference/PlotTF.html">PlotTF()</a></code> to make a plot of the transfer functions
obtained with <code><a href="../reference/CalculateDiffusionTF.html">CalculateDiffusionTF()</a></code> and/or
<code><a href="../reference/CalculateTimeUncertaintyTF.html">CalculateTimeUncertaintyTF()</a></code>.</li>
</ul>
</div>
<div class="section level2">
<h2 id="package-data">Package data<a class="anchor" aria-label="anchor" href="#package-data"></a>
</h2>
<p><code>proxysnr</code> ships with four package datasets:</p>
<ul>
<li>
<code><a href="../reference/dml.html">?dml</a></code> contains the oxygen isotope data of 15 firn cores
from Dronning Maud Land (DML), Antarctica (Graf et al., 2002);</li>
<li>
<code><a href="../reference/wais.html">?wais</a></code> contains the oxygen isotope data of 5 firn cores
from the West Antarctic Ice Sheet (WAIS; Steig, 2013);</li>
<li>
<code><a href="../reference/diffusion.tf.html">?diffusion.tf</a></code> contains pre-calculated diffusion
transfer functions for the DML and WAIS isotope records; and</li>
<li>
<code><a href="../reference/time.uncertainty.tf.html">?time.uncertainty.tf</a></code> contains pre-calculated time
uncertainty transfer functions for these records.</li>
</ul>
<p>The datasets can be used to test out the functions from
<code>proxysnr</code>, and they have been the basis for the analyses in
Münch and Laepple (2018); see also the
<code><a href="../articles/plot-muench-laepple-figures.html">vignette("plot-muench-laepple-figures")</a></code> for reproducing
their results.</p>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Graf, W., et al.: Stable-isotope records from Dronning Maud Land,
Antarctica, PANGAEA, doi: <a href="https://doi.org/10.1594/PANGAEA.728240" class="external-link">10.1594/PANGAEA.728240</a>,
2002.</p>
<p>Münch, T. and Laepple, T.: What climate signal is contained in
decadal- to centennial-scale isotope variations from Antarctic ice
cores?, Clim. Past, 14, 2053-2070, doi: <a href="https://doi.org/10.5194/cp-14-2053-2018" class="external-link">10.5194/cp-14-2053-2018</a>,
2018.</p>
<p>Steig, E. J.: West Antarctica Ice Core and Climate Model Data, U.S.
Antarctic Program (USAP) Data Center, doi: <a href="https://doi.org/10.7265/N5QJ7F8B" class="external-link">10.7265/N5QJ7F8B</a>, 2013.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Münch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
