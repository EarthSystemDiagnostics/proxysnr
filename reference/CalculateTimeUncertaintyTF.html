<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Time uncertainty transfer function — CalculateTimeUncertaintyTF • proxysnr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Time uncertainty transfer function — CalculateTimeUncertaintyTF"><meta name="description" content="This function implements an empirical Monte Carlo approach to estimate the
spectral transfer function for the effect of time uncertainty on the spatial
average of a common proxy signal recorded by a given core array. It requires
the suggested package simproxyage; if the package is not installed,
you will receive installation instructions upon calling this function."><meta property="og:description" content="This function implements an empirical Monte Carlo approach to estimate the
spectral transfer function for the effect of time uncertainty on the spatial
average of a common proxy signal recorded by a given core array. It requires
the suggested package simproxyage; if the package is not installed,
you will receive installation instructions upon calling this function."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">proxysnr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/proxysnr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/calculate-transfer-functions.html">Calculate transfer functions</a></li>
    <li><a class="dropdown-item" href="../articles/plot-muench-laepple-figures.html">Plot results of Münch &amp; Laepple (2018)</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/EarthSystemDiagnostics/proxysnr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Time uncertainty transfer function</h1>
      <small class="dont-index">Source: <a href="https://github.com/EarthSystemDiagnostics/proxysnr/blob/dev-1.0.0/R/CalculateTimeUncertaintyTF.R" class="external-link"><code>R/CalculateTimeUncertaintyTF.R</code></a></small>
      <div class="d-none name"><code>CalculateTimeUncertaintyTF.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function implements an empirical Monte Carlo approach to estimate the
spectral transfer function for the effect of time uncertainty on the spatial
average of a common proxy signal recorded by a given core array. It requires
the suggested package <code>simproxyage</code>; if the package is not installed,
you will receive installation instructions upon calling this function.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CalculateTimeUncertaintyTF</span><span class="op">(</span></span>
<span>  t <span class="op">=</span> <span class="fl">100</span><span class="op">:</span><span class="fl">1</span>,</span>
<span>  acp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">t</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>  nt <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span>,</span>
<span>  nc <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  ns <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"poisson"</span>,</span>
<span>  rate <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  resize <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  surrogate.fun <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span>,</span>
<span>  fun.par <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pad <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  df.log <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose.output <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>numeric vector of integer values providing a reference chronology
for the age perturbations (starting with the youngest age).</p></dd>


<dt id="arg-acp">acp<a class="anchor" aria-label="anchor" href="#arg-acp"></a></dt>
<dd><p>numeric vector of age control points where the age uncertainty is
assumed to be zero. Per default, a two-element vector where the first
element is the start age (<code>t[1]</code>) and the second element <code>NA</code>
resulting in an unconstrained age perturbation process; see details for
handling more age control points.</p></dd>


<dt id="arg-nt">nt<a class="anchor" aria-label="anchor" href="#arg-nt"></a></dt>
<dd><p>the length of the records (i.e. the number of data points) to
simulate; per default set to <code>length(t)</code>.</p></dd>


<dt id="arg-nc">nc<a class="anchor" aria-label="anchor" href="#arg-nc"></a></dt>
<dd><p>the number of cores in the modelled core array.</p></dd>


<dt id="arg-ns">ns<a class="anchor" aria-label="anchor" href="#arg-ns"></a></dt>
<dd><p>the number of Monte Carlo simulations for estimating the transfer
function.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>name string of the random process to use for realising the age
perturbations; must be either <code>"poisson"</code> (the default) or
<code>"bernoulli"</code>; see Comboul et al. (2014) for details on the two
models.</p></dd>


<dt id="arg-rate">rate<a class="anchor" aria-label="anchor" href="#arg-rate"></a></dt>
<dd><p>numeric vector of probability rate(s) that an age band is
perturbed; you can specify a vector of two rates where the first entry is
the probability for a missing band and the second entry the probability for
a double-counting of a band. If only a single value is specified (per
default 0.05), symmetric perturbations are assumed.</p></dd>


<dt id="arg-resize">resize<a class="anchor" aria-label="anchor" href="#arg-resize"></a></dt>
<dd><p>the resizing option in case of shorter/longer than original
time axes: 0 = do not resize, -1 = resize to shortest realisation, 1 =
resize to longest realisation (default).</p></dd>


<dt id="arg-surrogate-fun">surrogate.fun<a class="anchor" aria-label="anchor" href="#arg-surrogate-fun"></a></dt>
<dd><p>the random number generator to use for creating the
noise time series; per default, Gaussian white noise is created using the
base <code>R</code> function <code><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></code>.</p></dd>


<dt id="arg-fun-par">fun.par<a class="anchor" aria-label="anchor" href="#arg-fun-par"></a></dt>
<dd><p>an otional list of additional parameters which are passed to
<code>surrogate.fun</code>.</p></dd>


<dt id="arg-pad">pad<a class="anchor" aria-label="anchor" href="#arg-pad"></a></dt>
<dd><p>Strong age perturbations may result in time series that do not
reach the final age of the reference chronology – shall the resulting
<code>NA</code> values (in case of <code>resize = 1</code>) be set to <code>0</code> for the
spectral estimation? Defaults to <code>TRUE</code>. This should not influence the
spectral estimation provided the number of <code>NA</code> values is small
compared to the total length of the time series.</p></dd>


<dt id="arg-df-log">df.log<a class="anchor" aria-label="anchor" href="#arg-df-log"></a></dt>
<dd><p>width of the Gaussian kernel in logarithmic frequency units to
smooth the spectral estimates; <code>NULL</code> (the default) suppresses
smoothing. In general, smoothing should not be necessary when a
sufficiently large number of Monte Carlo simulations (parameter <code>ns</code>)
is used; nevertheless, it can be switched on here when the transfer
function still appears too noisy.</p></dd>


<dt id="arg-verbose-output">verbose.output<a class="anchor" aria-label="anchor" href="#arg-verbose-output"></a></dt>
<dd><p>logical controlling the size of the return object; per
default, only the transfer function spectrum is returned, else also the
spectra whose ratio determines the transfer function (see Details).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional parameters which are passed to the spectral estimation
function <code><a href="SpecMTM.html">SpecMTM</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>either a spectral object (<code><a href="spec.object.html">?spec.object</a></code>) of the transfer
  function if <code>verbose.output = FALSE</code> (default), or a list of the
  spectral objects <code>input</code>, <code>stack</code> and <code>ratio</code>, providing
  averages over the <code>ns</code> simulations of:</p><dl><dt><code>input</code>:</dt>
<dd><p>the original spectrum of the surrogate data;</p></dd>

  <dt><code>stack</code>:</dt>
<dd><p>the spectrum of the spatial average of the
        age-perturbed records;</p></dd>

  <dt><code>ratio</code>:</dt>
<dd><p>their ratio (perturbed/unperturbed), i.e. the transfer
        function.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The approach is described in detail in Münch and Laepple (2018). In brief,
<code>nc</code> identical surrogate time series are created and age perturbed and
the average of these time series is calculated. The process is repeated
<code>ns</code> times. For each of the <code>ns</code> realisations, spectra of the
average age-perturbed and original time series are calculated yielding the
spectral transfer function.</p>
<p>The modelling of the time uncertainty follows the approach presented in
Comboul et al. (2014) which is implemented in the package
<code>simproxyage</code>. The package can be installed from GitHub via<br><code>remotes::install_github("EarthSystemDiagnostics/simproxyage")</code><br>
or you can download the package repository from<br>
&lt;https://doi.org/10.5281/zenodo.2025204&gt;<br>
and install the package via <code>devtools::install()</code>.</p>
<p>The spectral estimates are calculated using Thomson’s multitaper method with
three windows with linear detrending before analysis.</p>
<p>Handling of age control points (see package <code>simproxyage</code> for more
details):</p>
<p>The function allows one to model the age uncertainty with several age
control points (ACP) where the age uncertainty evolves according to the
model of Comboul et al. (2014) between the age control points but is forced
back to zero time uncertainty at the ACPs following a Brownian Bridge
process.</p>
<p>Per default, the start age (i.e. the youngest age at the core top) is
assumed to be the first ACP, thus, if not set explicitly in the vector
<code>acp</code>, the youngest age is added as its first element. You can specify
an arbitrary number of additional ACPs. Between each pair of ACPs (starting
at the core top), constrained age perturbation realisations are performed
following the Comboul et al. (2014) model and the Brownian Bridge
concept. If the last ACP equals the oldest age in <code>t</code> (i.e. the last
proxy data point), the last core segment also follows a Brownian Bridge
process. Alternatively, if the last ACP is younger than the final age,
<code>NA</code> is added as the last element to the vector <code>acp</code> which
results in an unconstrained age perturbation process for the last core
segment.</p>
<p>ACPs lying outside the time interval defined by <code>t</code> will be removed
from the vector <code>acp</code> with a warning.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Comboul, M., Emile-Geay, J., Evans, M. N., Mirnateghi, N., Cobb, K. M.
and Thompson, D. M.: A probabilistic model of chronological errors in
layer-counted climate proxies: applications to annually banded coral
archives, Clim. Past, 10(2), 825-841,
https://doi.org/10.5194/cp-10-825-2014, 2014.</p>
<p>Münch, T. and Laepple, T.: What climate signal is contained in
decadal- to centennial-scale isotope variations from Antarctic ice cores?
Clim. Past, 14, 2053–2070, https://doi.org/10.5194/cp-14-2053-2018, 2018.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="spec.object.html">?spec.object</a></code> for the definition of a <code>proxysnr</code> spectral
  object.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Münch</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Thomas Münch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

